# Module 4 Lecture Notes

#####################################################
#### Section #1 - Intro (Discrete Distributions) #### 
#####################################################

# Numeric variables are either discrete or continuous. The outcomes of a continuous numeric variable come from a measuring process while those of a discrete variable come from a counting process. In this lecture, the probability distributions of discrete variables are explored. A probability distribution for a discrete random variable is defined in terms of a list of all possible numerical outcomes along with the probability of each outcome. The list of all outcomes is known as the support of the random variable. The probability distribution is specified in terms of a function, the probability mass function that maps each outcome to its probability.

###################################################
#### Random Variable Example - Number of Heads #### 
###################################################

# Let the random variable X be the number of heads observed when a fair coin is tossed three times. The support for X is SX = {0, 1, 2, 3}. For computing the probabilities, examine the sample space for the experiment:

# S = {HHH, HHT, HTH, HTT, THH, THT, TTH, TTT}

# Out of the eight outcomes, only one outcome (TTT) has the number of heads 0; three outcomes (HTT, THT, TTH) have the number of heads 1; three outcomes (HHT, HTH, THH) have the number of heads 2; and one outcome (HHH) has the number of heads 3.

# The problems on (PAGE 3) can be modeled in R as follows. The support set for the random variable and the probabilities for this distribution are:

(x <- c(0, 1, 2, 3))

(f <- c(1/8, 3/8, 3/8, 1/8))

# The mean of the distribution is:

(mu <-sum(x * f))

# The variance of the distribution is:

(sigmaSquare <- sum((x - mu)^2 * f))

# The standard deviation of the distribution is:

(sigma <- sqrt(sigmaSquare))

# The cumulative distribution for the random variable is:

(F <- cumsum(f))

###################################################
#### Random Variable Example - Age of Students #### 
###################################################

# Suppose the ages of ten students enrolled in a class are 21, 25, 27, 23, 21, 21, 25, 25, 21, and 27. Let the random variable X be the age of a randomly selected student in the class. The frequency distribution of X is shown in the table on (PAGE 5):

(ages <- c(21, 25, 27, 23, 21, 21, 25, 25, 21, 27))

(ctable <- table(ages))

# The above contingency table is converted to a data frame as follows:

(dframe <- as.data.frame(ctable))

# The inputs for the random variable X are the distinct ages:

(x <- as.numeric(as.character(dframe$ages)))

# Similarly, the probability distribution for the random variable is:

(f <- dframe$Freq / (sum(dframe$Freq)))

#######################################
#### Discrete Uniform Distribution #### 
#######################################

# A discrete uniform distribution is a symmetric probability distribution where a finite number of input values are equally likely. Consider the rolling of a single die. The outcomes 1, 2, ... , 6 are equally likely, each occurring with a probability of 1/6. If a discrete random variable X has m input values 1, 2, ... , m, then X has the discrete uniform distribution when P(X = x) = 1/m , for all values of x from 1 to m.

# The values can be explicitly computed in R as follows: (The input sequence is 1..6 and each of the 6 probabilities are 1/6.)

(x <- 1:6)

(f <- rep(1/6, 6))

# The mean value is calculated as follows:

(mu <- sum(x*f))

# The variance is computed using the following formula

(sigmaSquare <- sum((x - mu)^2 * f))

# The cumulative distribution function of the above discrete uniform random variable is calculated as follows:

x/6

# Sometimes, the input values for the discrete uniform random variable are in the integer range [a, b], inclusive where a < b. In this case, the probability mass function is (SEE PAGE 9)

# The rolling die example can be modeled in R as follows. The probability, P(X = 1), is:

(m <- 6)
dunif(1, max = m)

# The PMF can be generated as shown below.

(pmf <- dunif(1:m, max = m))

# A plot of the PMF for the uniform distribution using the following code is shown below.

plot(1:m, pmf, type='h', xlab='x', ylab='PMF', ylim = c(0, 0.2))
abline(h=0)

# The CDF for the above distribution is:

(cdf <- punif(1:m, max = m))

# The CDF can also be calculated using the PMF as follows:

cumsum(pmf)

# The qunif function is the quantile function that is the inverse of the punif function, i.e., it returns the value for which the CDF is given.
options(digits=2)
qunif(0.4, max = 6)

# The data for a discrete uniform random variable can be generated in R using the sample function with the replace option set to TRUE. The following code generates the data for a fair die rolled twenty times:

sample(6, size = 20, replace=T)

# The following code generates five random numbers in the given range from 10 to 20:

sample(10:20, size = 5, replace = T)

# The following code generates ten outcomes from flipping a fair coin:

sample(c("H", "T"), size = 10, replace = T)

##########################################
#### Binomial Distribution Background #### 
##########################################

# The binomial distribution is based on binomial coefficients and Bernoulli trials. A Bernoulli trial is a random experiment with only two possible outcomes, success and failure.

##########################
#### Bernoulli Trials #### 
##########################

# A Bernoulli trial is a random experiment in which there are only two possible outcomes—success (S) and failure (F). The random variable X in a Bernoulli trial is defined as follows:

# X = 1, if the outcome is a success (S), and X = 0, if the outcome is a failure (F). 

# Let the probability of success be p. Then the probability of failure is (1– p).

# Using R, the sample() function can be used to draw the samples with the specified distribution. The first argument is the list of outcomes 0, 1. Since the first outcome in this list is the negative outcome, its probability is 1– p. The following examples (PAGE 13) show ten random samples with p = 1 and p = 3 , respectively:

p <- 1/4
sample(0:1, size = 10, replace = T, prob = c(1-p,p))

p <- 3/4
sample(0:1, size = 10, replace = T, prob = c(1-p,p))

############################################
#### Section #2 - Binomial Distribution #### 
############################################

# The binomial distribution is the probability distribution for the number of successes in a sequence of Bernoulli trials. The number of outcomes that contain x successes out of n Bernoulli trails is the binomial coefficient (n). A binomial x random variable X counts the number of successes in n Bernoulli trials. The distribution of X is described by the two parameters, n (the number of trials) and p (the success probability).

# Notation

# X ~ binom(size = n, prob = p)

############################################
#### Bernoulli Trials—Coin Toss Example #### 
############################################

# A coin is tossed three times. Let success be the outcome of getting a head for each toss. Given that the coin is unfair and has an 80% chance of landing on heads, the probability of success, p, is 0.8. The probability of failure is 0.2. For each toss, let s denote the success outcome and f denote the failure outcome. The possible outcomes for three tosses and their corresponding probabilities are shown in the table on (PAGE 14):

#########################################
#### Example Using R—Tossing 5 Coins #### 
#########################################

# The coin-tossing example can be modeled using R as follows. Suppose a fair coin is tossed five times. The random variable X is the number of heads, and success probability is 1/2.

# The probability that, say, X = 3, can directly be calculated using the binomial formula as shown below.
options(digits=4)

n <- 5
p <- 1/2

choose(n,3) * p^3 * (1-p)^2

# The stats package provides the dbinom function to compute the probability for the given value of X . The probability for X = 3 can be calculated as follows.

dbinom(3, size = n, prob = p)

# The probability mass function for a sequence (or list) of values can be directly calculated as shown below. The following arguments for the function calculate all probabilities for 0..n.

dbinom(0:n, size = n, prob = p)

# Similarly, the probabilities for X = 1 and X = 5 can be calculated by providing the list of values as the first argument.

dbinom(c(1,5), size = n, prob = p)

# The probability for three or fewer heads, P(X <| 3), can be calculated as the sum of the probabilities P(X = 0) + P(X = 1) + P(X = 2) + P(X = 3). The cumulative probability is shown below.

sum(dbinom(0:3, size = n, prob = p))

# The pbinom function provides the alternative to directly compute the cumulative probability. P(X % 3) is also calculated as shown below.

pbinom(3, size = n, prob = p)

# The probability of 4 or more heads can be calculated as P(X = 4) + P(X = 5) as shown below.

sum(dbinom(4:n, size = n, prob = p))

# The above probability is the same as 1 $ P(X % 3). Using the pbinom function, the value is:

1 - pbinom(3, size = n, prob = p)

# Instead of using the complement, the value P(X |> 4), or P(X > 3), can be calculated by providing the additional argument lower.tail = FALSE in the formula for computing P(X <| 3) as shown below. This adds the values of the probabilities from the next integer of the first argument to the size of the experiment.

pbinom(3, size = n, prob = p, lower.tail = F)

# A spike plot of the probability distribution for the binomial random variable can be produced as shown below. The probabilities, computed as heights, correspond to the input values 0..n. The plot is generated for the sequence using the vertical lines (type = "h"). The tops of the lines are shown as points with the plotting character of a filled circle.

heights <- dbinom(0:n, size = n, prob = p)
plot(0:n, heights, type = "h", main = "Spike splot of X", xlab = "x", ylab = "PMF")
points(0:n, heights, pch = 16)

########################
### Plotting the CDF ###
########################

# The cumulative distribution function of the binomial random variable can be plotted in R by using the cumsum and stepfun functions. Given the probabilities, the cumsum function returns the cumulative probabilities. The first value of 0 (corresponding to FX (x), x < 0) is inserted into the cdf variable.
# Thestepfun, for the given values of (x1,x2,...,xn) and (y0,y1,y2,...,yn), returns piecewise constant functions. The values returned by this function are constant for [x0 , xi+1 ). The following example shows how a stepfun works:

x <- c(0,1,2,3)
y <- c(0,10,20,30,40)

stepfun(x,y)

# For the coin-tossing examples, the CDF is plotted as shown below. The step function values are plotted using the plot function. The verticals option is FALSE so that vertical lines are not drawn at the steps.

n <- 5
p <- 1/2

pmf <- dbinom(0:n, size = n, prob = p)
cdf <- c(0, cumsum(pmf))
cdfplot <- stepfun(0:n, cdf)
plot(cdfplot, verticals = F, pch = 16, main = "Step plot", xlab = "x", ylab = "CDF")

# The qbinom function is the quantile function that is the inverse of the pbinom function, i.e., it returns the value for which the CDF is given.

qbinom(0.8125, size = n, prob = p)

# The rbinom function can be used to generate random numbers according to the binomial distribution.

rbinom(10, size = n, prob = p)

# A plot of the frequency distribution of a sample of 1000 numbers following the binomial distribution can be generated as shown below.

y <- rbinom(1000, size = n, prob = p)
table(y)
plot(table(y), type = "h", col="red")

###################################
### Hypergeometric Distribution ###
###################################

# In the binomial distribution, the Bernoulli trials are independent of each other and hence the probability of success remains the same for each trial. Also, the sample data is selected with replacement. In the hypergeometric distribution, the sample data is selected without replacement. Hence, the outcomes are dependent on the previous observations. See (PAGE 31) for all examples.

# Notation
# X ~ hyper(m = M, n = N, k = K)

# The associated R functions for the PMF and CDF of the hypergeometric distribution are dhyper(x, m, n, k) and phyper(x, m, n, k), respectively. The above problem with five white balls, three black balls, and a sample size of two is modeled as follows:

M <- 5
N <- 3
K <- 2

(pmf <- dhyper(0:K, m = M, n = N, k = K))

# The corresponding cumulative probabilities are shown below.

(cdf <- phyper(0:K, m = M, n = N, k = K))

# The quantile function, qhyper, is the inverse of the phyper function, returning the number for the specified CDF.

qhyper(0.64, m = M, n = N, k = K)

rhyper(10, m = M, n = N, k = K)

######################################
### Example Using R - Faulty Chips ###
######################################

# Suppose there are 20 faulty chips out of manufactured lot of 1000 chips. For quality control, 50 chips are selected at random without replacement. The random variable is the number of faulty chips in the selected sample. In this hypergeometric distribution, M = 20, N = 980, and K = 50.

# The probability of exactly 2 faulty chips in the sample using R:

M <- 20
N <- 980
K <- 50

dhyper(2, m = M, n = N, k = K)

sum(dhyper(0:2, m = M, n = N, k = K))

phyper(2, m = M, n = N, k = K)

# To calculate P(X |>) 3) = P(X > 2), the lower.tail property of the phyper function is used. This is equivalent to 1 $ P(<| 2)

phyper(2, m = M, n = N, k = K, lower.tail = F)

# The probability distribution for the number of faulty chips can be calculated and plotted as follows:

(pmf <- dhyper(0:K, m = M, n = N, k = K))
plot(0:K, pmf, typer = "h", xlab = "x", ylab = "PMF", ylim = c(0, 0.5))
abline(h=0)

#############################################
#### Section #3 - Geometric Distribution #### 
#############################################

# The geometric distribution concerns the number of failures before a success occurs in a sequence of Bernoulli trials. In a geometric distribution, the random variable X is the number of failures before a success

# Notation - X ~ geom(prob = p)

# The associated R functions for the PMF and CDF of the geometric distribution are dgeom(x, prob) and pgeom(x, prob), respectively. Consider the coin-tossing example with a fair coin where the probability of success (say, getting a head) is 1.

# THe probabilities from table on (PAGE 36) are computed in R as follows
options(digits = 3)
p <- 1/2
dgeom(2, prob = p)

# Similarly, the PMF can be calculated in R as follows:

(pmf <- dgeom(0:10, prob = p))

# The plot of the above distribution is shown below.

plot(0:10, pmf, type = "h", xlab = "x", ylab = "PMF")
abline(h=0)

#####################################################
#### Section #3 - Negative Binomial Distribution #### 
#####################################################

# The negative binomial distribution concerns the number of failures until a total of r successes occur in a sequence of Bernoulli trials. In a negative binomial distribution, the random variable X is the number of failures that precede the rth success.

# Notation: X ~ nbinom(size = r, prob = p)

# The associated R functions for the PMF and CDF of the negative binomial distribution are dnbinom(x, size, prob) and pnbinom(x, size, prob), respectively.

r <- 3
p <- 1/2

dnbinom(5, size = r, prob = p)

# The probability mass function of the negative binomial variable is calculated in R as follows:

(pmf <- dnbinom(0:10, size = r, prob = p))

# The plot of the above distribution is shown below.

plot(0:10, pmf, type = "h", xlab = "x", ylab = "PMF", ylim = c(0, 0.2))
abline(h=0)

# The probability that at most 5 failures are observed is:
#          P(X %5)=P(X =0)+p(X =1+...+P(X =5))
# The cumulative probability can be computed in R as follows:

pnbinom(5, size = r, prob = p)

# The plot for the cumulative distribution function is shown below.

(cdf <- c(0, cumsum(pmf)))

cdfplot <- stepfun(0:10, cdf)
plot(cdfplot, pch = 16, main = "", xlab = "x", ylab = "CDF")

###########################################
#### Section #4 - Poisson Distribution #### 
###########################################




































#########################
### Formulas for Quiz ###
#########################

# Suppose you go to bed at 10 PM and wake up at 6 AM and check your email the first thing after waking up. On an average, your inbox receives 105 emails during that period. What is the probability that you will have in between 97 and 109 emails (both inclusive) to read? (round the answer to three decimals)

diff(ppois(c(96, 109), lambda=105))

# Suppose you go to bed at 10 PM and wake up at 6 AM and check your email the first thing after waking up. On an average, your inbox receives 110 emails during that period. What is the probability that you will have at most 107 emails to read? (round the answer to three decimals)

ppois(107, lambda=110)


# Suppose you go to bed at 10 PM and wake up at 6 AM and check your email thefirst thing after waking up. On an average, your inbox receives 70 emails during that period. What is the probability that you will have exactly 70 emails to read? (round the answer to three decimals)
 
dpois(70, lambda=70)

# Suppose the scores of an exam follow a normal distribution with mean = 65 and standard deviation = 6. What is the chance that a randomly selected student will score at least 75? (round up the answer to nearest integer)

pnorm(75, mean = 65, sd=6)

# Suppose the scores of an exam follow a normal distribution with mean = 55 and standard deviation = 6. What is the chance that a randomly selected student will score in between 46 and 65? (round up the answer to nearest integer)

pnorm(46:65, mean = 55, sd=6)


# Suppose the scores of an exam follow a normal distribution with mean = 70 and standard deviation = 6. What is the minimum score that a randomly selected student should get to be in the top 5%? (round up the answer to nearest integer)

qnorm(0.95, mean = 70, sd=6)



# Suppose a discrete random variable has a uniform distribution from 1 to 50. The probability that the random variable is at least 28 is

punif(28, max=50, lower.tail = F)

# Suppose the scores of an exam are all integer scores and follow a discrete uniform distribution from 50 to 80. The probability that a randomly selected student will score 76 is
dunif(76, min = 50, max = 80)


sum(dbinom(0:3, size=5, prob=0.24))

# At the carnival, you decided to play the balloon and dart game to pop the balloons with the darts. You are provided 5 darts. Your chance of popping a balloon with a dart is 24%. What is the probability that you will pop at least 3 balloons with the 5 darts (round the answer to three decimals)?
pbinom(2, size=5, prob=0.24, lower.tail = F) 

# At the carnival, you decided to play the balloon and dart game to pop the balloons with the darts. You are provided 5 darts. Your chance of popping a balloon with a dart is 77%. What is the probability that you will pop atmost 4 balloons with the 5 darts (round the answer to three decimals)?
pbinom(0:4, size=5, prob=0.77, lower.tail = T) 


# At the carnival, you decided to play the balloon and dart game to pop the balloons with the darts. You are provided 5 darts. Your chance of popping a balloon with a dart is 80%. What is the probability that you will pop exactly 2 balloons with the 5 darts (round the answer to three decimals)?
dbinom(2, size = 5, prob = 0.80)

# In a game of chutes and ladders, suppose you need a 3 to win the game. You are rolling a 6-faced fair die. What is the probability that you will win the game on the eighth try? (round the answer to four decimals)

set.seed(10)
library(purrr)
count = 0
for(i in 1:10000)
{
j = 1
x = rdunif(1, 6, 1)
while(x != 5)
{
j = j+1
x = rdunif(1, 6, 1)
}
if(j == 8)
{
count = count + 1
}
}
count/10000

# In a game of chutes and ladders, suppose you need a 6 to win the game. You are rolling a 6-faced fair die. What is the probability that you will win the game in at most 6 tries? (round the answer to four decimals)

set.seed(10)
library(purrr)
count = 0
for(i in 1:10000)
{
j = 1
x = rdunif(1, 6, 1)
while(x != 5)
{
j = j+1
x = rdunif(1, 6, 1)
}
if(j <= 6)
{
count = count + 1
}
}
count/10000

# A fair coin (Heads/Tails) is tossed 16 times. What is the probability that you will get extactly 7 Heads? (round the answer to four decimals)

n <- 16

p <- 1/2

dbinom(7, size = n, prob = p)

# A fair coin (Heads/Tails) is tossed 6 times. What is the probability that you will get at least 2 Heads? (round the answer to four decimals)

n <- 6

p <- 1/2

pbinom(1, size = n, prob = p, lower.tail = F)

# An M&M candy dispenser has 25 red, 25 blue, and 25 green M&Ms. The dispenser dispenses 20 M&Ms each time. What is the probability, that on the first use, you will get at most 3 red M&Ms out of the 20 dispensed. (round the answer to three decimals)

M <- 25
N <- 50
K <- 20

sum(dhyper(0:3, m = M, n = N, k = K))

# An M&M candy dispenser has 30 red, 30 blue, and 30 green M&Ms. The dispenser dispenses 20 M&Ms each time. What is the probability, that on the first use, you will get 9 blue M&Ms out of the 20 dispensed. (round the answer to three decimals)

M <- 30
N <- 60
K <- 20
sum(dhyper(9, m = M, n = N, k = K))

# Consider a slot machine with 3 wheels (reels). Each reel has 10 slots, 0, 1, ..., 9. Suppose you have a win if the 3 slots match (0-0-0, 1-1-1, ..., 9-9-9). You decided to play until you win 3 times. What is the probability that you will walk out after exactly 355 tries? (round the answer to four decimals)

p <- 0.008450704225

dnbinom(355, size = 3, prob = p)

# Consider a slot machine with 3 wheels (reels). Each reel has 10 slots, 0, 1, ..., 9. Suppose you have a win if the 3 slots match (0-0-0, 1-1-1, ..., 9-9-9). You decided to play until you win 3 times. What is the probability that you will walk out after at most 315 tries? (round the answer to four decimals)


p <- 0.009523809524

pnbinom(315, size = 3, prob = p)

# Consider a slot machine with 3 wheels (reels). Each reel has 10 slots, 0, 1, ..., 9. Suppose you have a win if the 3 slots match (0-0-0, 1-1-1, ..., 9-9-9). You decided to play until you win 3 times. The machine says that your chances of matching the 3 slots is 59%. What is the minimum number of tries you will need to win 3 times?

p <- 0.01966666667

qnbinom(0.59, size = 3, prob = p) * 2






























